<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Book hotels, restaurants, car rentals, and events across Saudi Arabia with Saudi Guider."
    />
    <title>Our Services - Saudi Guider</title>
    <link rel="icon" type="image/x-icon" href="./images/S_NoBack_500x500.png" />
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
    <script src="./js/shared.js" defer></script>
    <script src="./js/loadCommon.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      :root {
        --primary: #5b6a7f;
        --secondary: #8fb6c0;
        --secondary-dark: #4c8ba9;
        --light: #f0f0f0;
        --dark: #212121;
        --dark-gray: #2a2a2a;
        --darker-gray: #1a1a1a;
        --medium-gray: #3a3a3a;
        --border-gray: #3a3a3a;
        --font-main: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        --transition-speed: 0.3s;
        --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
        --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        --feature-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      }
        
      /* CSS Reset */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html {
        scroll-behavior: smooth;
      }

      /* Base Styles */
      body {
        font-family: var(--font-main);
        background: linear-gradient(135deg, var(--primary), var(--secondary));
        color: var(--light);
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      main {
        flex: 1;
        padding-top: 6rem;
      }
             .error-state, .no-results, .loading-state {
            text-align: center;
            padding: 2rem;
            background: var(--medium-gray);
            border-radius: 8px;
            margin: 1rem 0;
        }

        .error-state i, .no-results i {
            font-size: 3rem;
            color: #ff5252;
            margin-bottom: 1rem;
        }

        .no-results i {
            color: var(--secondary);
        }

        .loading-state i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

      img {
        max-width: 100%;
        height: auto;
        display: block;
      }

      /* Typography */
      h1,
      h2,
      h3 {
        line-height: 1.2;
        margin-bottom: 0.5em;
      }

      h1 {
        font-size: 2.5rem;
      }

      h2 {
        font-size: 2rem;
      }

      h3 {
        font-size: 1.5rem;
      }

      p {
        margin-bottom: 1rem;
      }

      /* Focus States */
      a:focus,
      button:focus,
      input:focus,
      select:focus {
        outline: 2px solid var(--light);
        outline-offset: 2px;
      }

      /* Header */
      header {
        background: linear-gradient(90deg, var(--primary), var(--secondary));
        color: var(--light);
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem 2rem;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000;
        box-shadow: var(--box-shadow);
      }

      .logo {
        display: flex;
        align-items: center;
      }

      .logo img {
        width: 60px;
        margin-right: 10px;
      }

      .logo a {
        font-size: 1.75rem;
        font-weight: bold;
        text-decoration: none;
        color: var(--light);
      }

      /* Navigation */
      nav ul {
        display: flex;
        gap: 1.5rem;
        list-style: none;
      }

      nav a {
        color: var(--light);
        text-decoration: none;
        font-size: 1.1rem;
        transition: color var(--transition-speed) ease;
        padding: 0.5rem;
      }

      nav a:hover,
      nav a:focus {
        color: #ffffff;
      }

      nav a.active {
        border-bottom: 2px solid #ffffff;
        padding-bottom: 3px;
      }

      /* Auth Buttons */
      .auth-buttons {
        display: flex;
        gap: 15px;
      }
      .user-dropdown {
        position: relative;
        display: none;
      }

      .user-toggle {
        background: none;
        border: none;
        color: white;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 0.5rem 1rem;
      }

      .dropdown-menu {
        display: none;
        position: absolute;
        right: 0;
        background-color: var(--dark-gray);
        min-width: 200px;
        box-shadow: var(--box-shadow);
        border-radius: 6px;
        z-index: 1001;
        padding: 0.5rem 0;
      }

      .dropdown-menu a {
        color: var(--light);
        padding: 0.75rem 1rem;
        text-decoration: none;
        display: block;
      }

      .dropdown-menu a:hover {
        background-color: var(--medium-gray);
      }

      .user-dropdown:hover .dropdown-menu {
        display: block;
      }

      .auth-buttons button {
        background-color: #69a7c8;
        border: none;
        color: var(--light);
        padding: 0.5rem 1rem;
        border-radius: 5px;
        font-size: 1rem;
        cursor: pointer;
        text-decoration: none;
        transition: background-color var(--transition-speed) ease;
      }

      .auth-buttons button:hover,
      .auth-buttons button:focus {
        background-color: #4c8ba9;
      }

      /* Mobile Nav Toggle */
      .mobile-nav-toggle {
        display: none;
        background: transparent;
        border: none;
        color: var(--light);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0.5rem;
      }

      #results-container .view-result-btn {
        display: none !important;
      }

      /* Hero Section */
      .services-hero {
        padding: 4rem 2rem;
        background-color: var(--dark);
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .services-hero h1 {
        margin-bottom: 0.5rem;
      }

      .services-hero p {
        font-size: 1.2rem;
        margin-bottom: 1.5rem;
        max-width: 800px;
      }

      /* Sections */
      .section {
        padding: 3rem 2rem;
      }

      .section-title {
        text-align: center;
        margin-bottom: 2rem;
      }
        /* Booking Messages */
.booking-message {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 350px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  overflow: hidden;
  z-index: 1000;
  animation: slideIn 0.3s ease-out;
  transition: opacity 0.3s;
}

.booking-message.success {
  border-top: 4px solid #4CAF50;
}

.message-content {
  display: flex;
  align-items: center;
  padding: 15px;
  gap: 12px;
}

.message-content i {
  font-size: 24px;
  color: #4CAF50;
}

.message-content h4 {
  margin: 0 0 4px 0;
  color: #333;
}

.message-content p {
  margin: 0;
  color: #666;
  font-size: 14px;
}

.close-message {
  margin-left: auto;
  background: none;
  border: none;
  font-size: 20px;
  cursor: pointer;
  color: #999;
}

.message-actions {
  display: flex;
  border-top: 1px solid #eee;
  padding: 12px;
}

.message-actions button {
  flex: 1;
  padding: 8px;
  background: #f5f5f5;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* Reservations List */
.reservations-list {
  display: grid;
  gap: 16px;
  margin-top: 20px;
}

.reservation-card {
  border: 1px solid #eee;
  border-radius: 8px;
  padding: 16px;
  transition: all 0.2s;
}
/* Add to your existing CSS */
.reservation-card {
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: transform 0.2s;
}

.reservation-card:hover {
  transform: translateY(-3px);
}

.reservation-image {
  height: 160px;
  background-color: #f0f0f0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 60px;
  color: #1e3a8a;
}

.reservation-details {
  padding: 15px;
}

.amenities {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.amenity-tag {
  background: #e0f2fe;
  color: #0369a1;
  padding: 4px 8px;
  border-radius: 20px;
  font-size: 12px;
}

.special-requests {
  margin-top: 15px;
  padding-top: 15px;
  border-top: 1px dashed #e5e7eb;
}

.special-requests p {
  margin: 5px 0;
  color: #666;
}
.reservation-card:hover {
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.reservation-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.status-badge {
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: bold;
}

.status-badge.confirmed {
  background: #e8f5e9;
  color: #2e7d32;
}

.reservation-details {
  display: grid;
  gap: 8px;
  margin-bottom: 16px;
  color: #555;
}

.reservation-details i {
  width: 20px;
  text-align: center;
  color: #777;
}

.reservation-actions {
  display: flex;
  gap: 8px;
}

.reservation-actions button {
  flex: 1;
  padding: 8px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

.cancel-btn {
  background: #ffebee;
  color: #c62828;
}

.details-btn {
  background: #e3f2fd;
  color: #1565c0;
}

@keyframes slideIn {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

      .section-text {
        max-width: 800px;
        margin: 0 auto 2rem;
        text-align: center;
      }

      /* Search Section */
      .search-section {
        background-color: var(--dark-gray);
      }

      .search-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .search-tabs {
        display: flex;
        border-bottom: 1px solid var(--border-gray);
      }

      .search-tab {
        padding: 1rem 1.5rem;
        background: var(--medium-gray);
        border: none;
        cursor: pointer;
        color: var(--light);
        font-size: 1.1rem;
        transition: background-color var(--transition-speed);
      }

      .search-tab:first-child {
        border-top-left-radius: 8px;
      }

      .search-tab:last-child {
        border-top-right-radius: 8px;
      }

      .search-tab.active {
        background: var(--secondary);
      }

      .search-tab:hover {
        background: var(--secondary-dark);
      }
        .service-type-group {
  margin-bottom: 2rem;
}

.service-type-title {
  color: var(--secondary);
  padding-bottom: 0.5rem;
  border-bottom: 1px solid var(--border-gray);
  margin-bottom: 1rem;
}
      .search-form {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--medium-gray);
        border-radius: 0 8px 8px 8px;
      }

      .form-group {
        flex: 1;
        min-width: 200px;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid var(--border-gray);
        border-radius: 4px;
        background-color: var(--dark);
        color: var(--light);
        font-family: inherit;
        font-size: inherit;
      }

      .search-button {
        background-color: var(--secondary);
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color var(--transition-speed);
        align-self: flex-end;
      }

      .search-button:hover {
        background-color: var(--secondary-dark);
      }

      /* Search Results */
      .search-results {
        display: none;
        background-color: var(--medium-gray);
        border-radius: 8px;
        padding: 2rem;
        margin-top: 1rem;
      }

      .search-results.active {
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
}

      /* Results Grid Layout */
      .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        width: 100%;
      }

      /* Result Card Styling */
      .result-item {
        background: var(--dark-gray);
        border-radius: 8px;
        padding: 20px;
        transition: transform 0.3s ease;
        box-shadow: var(--card-shadow);
      }

      .result-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      }

      .result-image {
        height: 180px;
        background: var(--medium-gray);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 15px;
      }

      .result-image i {
        font-size: 3rem;
        color: var(--secondary);
      }

      .result-details h3 {
        margin: 0 0 10px 0;
        color: white;
        font-size: 1.2rem;
      }

      .location, .price, .rating {
        margin: 8px 0;
        color: var(--light);
      }

      .price {
        font-weight: bold;
        font-size: 1.1rem;
        color: var(--secondary);
      }

      .rating {
        color: gold;
      }

      .amenities {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 15px 0;
      }

      .amenity-tag {
        background: var(--secondary-dark);
        color: white;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.8rem;
      }

      .book-btn {
        background: var(--secondary);
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        cursor: pointer;
        width: 100%;
        font-weight: bold;
        transition: background 0.3s ease;
      }

      .book-btn:hover {
        background: var(--secondary-dark);
      }

      /* Loading State */
      .loading-state {
        text-align: center;
        padding: 40px;
      }
        .fetch-all-container {
  margin: 1rem 0;
  text-align: center;
}

#fetchAllBtn {
  background-color: var(--secondary-dark);
  margin: 0 auto;
}

#fetchAllBtn:hover {
  background-color: var(--secondary);
}

      /* No Results State */
      .no-results {
        text-align: center;
        padding: 40px;
      }

      .no-results i {
        font-size: 3rem;
        color: var(--secondary);
        margin-bottom: 20px;
      }

      .no-results-message h4 {
        margin-bottom: 0.5rem;
      }

      .no-results-message p {
        opacity: 0.8;
      }
      .section-flex {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 50px;
      }

      /* Search form enhancements */
      .sort-controls {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding: 0.5rem 0;
        border-bottom: 1px solid var(--border-gray);
      }

      .sort-options {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .sort-options select {
        padding: 0.5rem;
        background-color: var(--dark);
        color: var(--light);
        border: 1px solid var(--border-gray);
        border-radius: 4px;
      }

      .results-count {
        color: var(--secondary);
        font-weight: 600;
      }

      /* Amenities tags */
      .amenities {
        display: flex;
        gap: 0.5rem;
        margin: 0.5rem 0;
        flex-wrap: wrap;
      }

      .amenity-tag {
        background-color: var(--secondary-dark);
        color: white;
        padding: 0.3rem 0.6rem;
        border-radius: 12px;
        font-size: 0.8rem;
      }

      /* Featured badge */
      .featured-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: var(--secondary);
        color: white;
        padding: 0.3rem 0.6rem;
        border-radius: 4px;
        font-size: 0.8rem;
        font-weight: bold;
      }

      /* Multi-select styling */
      select[multiple] {
        height: auto;
        min-height: 100px;
      }

      select[multiple] option {
        padding: 0.5rem;
        margin: 0.2rem 0;
        background-color: var(--dark);
        color: var(--light);
      }

      select[multiple] option:checked {
        background-color: var(--secondary);
        color: white;
      }

      /* Loading and Reservation Modals */
      .loading-modal, .reservation-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 3000;
      }

      .loading-content, .reservation-content {
        background-color: var(--dark-gray);
        padding: 2rem;
        border-radius: 8px;
        text-align: center;
        max-width: 400px;
        width: 90%;
      }

      .loading-content i {
        font-size: 2rem;
        color: var(--secondary);
        margin-bottom: 1rem;
      }

      .reservation-content i {
        font-size: 3rem;
        margin-bottom: 1rem;
      }

      .reservation-content i.fa-check-circle {
        color: #4CAF50;
      }

      .reservation-content i.fa-exclamation-circle {
        color: #ff5252;
      }

      .reservation-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
        justify-content: center;
      }

      .reservation-actions button {
        padding: 0.8rem 1.5rem;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s;
      }

      .reservation-actions button:first-child {
        background-color: var(--secondary);
        color: white;
      }

      .reservation-actions button:first-child:hover {
        background-color: var(--secondary-dark);
      }

      .reservation-actions button:last-child {
        background-color: var(--dark);
        color: var(--light);
        border: 1px solid var(--secondary);
      }

      .reservation-actions button:last-child:hover {
        background-color: var(--border-gray);
      }

      /* Login Message */
      .login-message {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 3000;
      }

      .login-message-content {
        background-color: var(--dark-gray);
        padding: 2rem;
        border-radius: 8px;
        text-align: center;
        max-width: 400px;
        width: 90%;
      }

      .login-message p {
        margin-bottom: 1.5rem;
        font-size: 1.1rem;
      }

      .login-actions {
        display: flex;
        gap: 1rem;
        justify-content: center;
      }

      .login-redirect-btn {
        background-color: var(--secondary);
        color: white;
        border: none;
        padding: 0.8rem 1.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color var(--transition-speed);
      }

      .login-redirect-btn:hover {
        background-color: var(--secondary-dark);
      }

      .login-cancel-btn {
        background-color: var(--dark);
        color: var(--light);
        border: 1px solid var(--secondary);
        padding: 0.8rem 1.5rem;
        border-radius: 5px;
        cursor: pointer;
        font-size: 1rem;
        transition: background-color var(--transition-speed);
      }

      .login-cancel-btn:hover {
        background-color: var(--border-gray);
      }

      /* Service Categories */
      .service-categories {
        background-color: var(--dark-gray);
      }

      .category-container {
        max-width: 1500px;
        margin: 0 auto;
      }

      /* Service Cards */
      .service-cards {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
        gap: 2rem;
        justify-content: center;
      }

      .service-card {
        background-color: var(--medium-gray);
        border-radius: 10px;
        overflow: hidden;
        box-shadow: var(--card-shadow);
        transition: transform var(--transition-speed);
      }

      .service-card:hover {
        transform: translateY(-5px);
      }

      .service-card-image {
        height: 200px;
        overflow: hidden;
      }

      .service-card-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform var(--transition-speed);
      }

      .service-card:hover .service-card-image img {
        transform: scale(1.05);
      }

      .service-card-content {
        padding: 1.5rem;
      }

      .service-card-title {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
      }

      .service-price {
        color: var(--secondary);
        font-weight: bold;
        font-size: 1.1rem;
        padding-left: 10px;
      }

      .service-features {
        list-style: none;
        margin: 1rem 0;
      }

      .service-features li {
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
      }

      .service-features i {
        color: var(--secondary);
        margin-right: 0.5rem;
        min-width: 20px;
        text-align: center;
      }

      .service-card-actions {
        display: flex;
        gap: 1rem;
        margin-top: 1.5rem;
      }
    /* Success/Error Messages */
#booking-success, #booking-error {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 2rem;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
  z-index: 1000;
  text-align: center;
  max-width: 90%;
  width: 400px;
  animation: fadeIn 0.3s;
}

#booking-success {
  border-top: 4px solid #4CAF50;
}

#booking-error {
  border-top: 4px solid #f44336;
}

.success-content i {
  color: #4CAF50;
  font-size: 3rem;
  margin-bottom: 1rem;
}

.error-content i {
  color: #f44336;
  font-size: 3rem;
  margin-bottom: 1rem;
}

#booking-success a, #booking-error a {
  display: block;
  margin-top: 1rem;
  color: #2196F3;
  text-decoration: underline;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translate(-50%, -40%); }
  to { opacity: 1; transform: translate(-50%, -50%); }
}
      .view-details-btn,
      .book-now-btn {
        padding: 0.7rem 1rem;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        font-size: 0.9rem;
        text-align: center;
        flex: 1;
        transition: all var(--transition-speed);
      }

      .view-details-btn {
        background-color: var(--dark);
        color: var(--light);
      }

      .view-details-btn:hover {
        background-color: var(--border-gray);
      }

      .book-now-btn {
        background-color: var(--secondary);
        color: white;
      }

      .book-now-btn:hover {
        background-color: var(--secondary-dark);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 2000;
        overflow: auto;
        justify-content: center;
        align-items: center;
        padding: 2rem;
      }

      .modal-content {
        background-color: var(--dark-gray);
        border-radius: 10px;
        max-width: 800px;
        width: 90%;
        position: relative;
        animation: modalFadeIn 0.3s;
      }

      @keyframes modalFadeIn {
        from {
          opacity: 0;
          transform: translateY(-50px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .modal-header {
        padding: 1.5rem;
        border-bottom: 1px solid var(--border-gray);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-title {
        margin: 0;
      }

      .close-modal {
        background: transparent;
        border: none;
        color: var(--light);
        font-size: 1.5rem;
        cursor: pointer;
        padding: 0.5rem;
      }

      .modal-body {
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .modal-image-gallery {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
        overflow-x: auto;
        padding-bottom: 1rem;
      }

      .modal-image-gallery img {
        width: 150px;
        height: 100px;
        object-fit: cover;
        border-radius: 5px;
        cursor: pointer;
        transition: all var(--transition-speed);
      }

      .modal-image-gallery img:hover {
        transform: scale(1.05);
      }

      .modal-details {
        display: flex;
        flex-wrap: wrap;
        gap: 2rem;
      }

      .modal-info {
        flex: 1;
        min-width: 300px;
      }

      .modal-features {
        flex: 1;
        min-width: 300px;
      }

      .detail-list {
        list-style: none;
      }

      .detail-list li {
        margin-bottom: 0.8rem;
        display: flex;
        align-items: flex-start;
      }

      .detail-list i {
        color: var(--secondary);
        margin-right: 0.5rem;
        min-width: 20px;
        text-align: center;
      }

      .modal-footer {
        padding: 1.5rem;
        border-top: 1px solid var(--border-gray);
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
      }

      .modal-footer button {
        background-color: var(--secondary);
        color: white;
        padding: 0.7rem 1rem;
        border-radius: 5px;
        border: none;
        cursor: pointer;
        font-size: 0.9rem;
        text-align: center;
        transition: background-color var(--transition-speed);
      }

      .modal-footer button:hover {
        background-color: var(--secondary-dark);
      }

      /* Footer */
      footer {
        text-align: center;
        padding: 1.5rem;
        background-color: var(--dark);
        color: var(--light);
      }

      .footer-content {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 2rem;
        margin-bottom: 1.5rem;
        text-align: left;
        max-width: 1200px;
        margin: 0 auto;
      }

      .footer-section h3 {
        margin-bottom: 1rem;
        color: var(--secondary);
      }

      .footer-section ul {
        list-style: none;
      }

      .footer-section ul li {
        margin-bottom: 0.5rem;
      }

      .footer-section a {
        color: var(--light);
        text-decoration: none;
        transition: color var(--transition-speed);
      }

      .footer-section a:hover,
      .footer-section a:focus {
        color: var(--secondary);
        text-decoration: underline;
      }

      .social-icons {
        display: flex;
        gap: 1rem;
        margin-top: 1rem;
      }

      .social-icons a {
        color: var(--light);
        font-size: 1.5rem;
        transition: color var(--transition-speed);
      }

      .social-icons a:hover,
      .social-icons a:focus {
        color: var(--secondary);
      }

      .footer-bottom {
        border-top: 1px solid var(--border-gray);
        padding-top: 1.5rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      /* Responsive Design */
      @media (max-width: 992px) {
        .service-cards {
          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }
      }

      @media (max-width: 768px) {
        header {
          padding: 1rem;
        }

        .mobile-nav-toggle {
          display: block;
        }

        nav {
          position: fixed;
          top: 80px;
          left: -100%;
          width: 100%;
          background-color: var(--dark);
          height: calc(100vh - 80px);
          transition: left var(--transition-speed) ease;
          z-index: 999;
          padding: 2rem;
        }

        nav.active {
          left: 0;
        }

        nav ul {
          flex-direction: column;
          align-items: center;
        }

        .auth-buttons {
          margin-right: 1rem;
        }

        .section {
          padding: 2rem 1rem;
        }

        .services-hero {
          padding: 3rem 1rem;
        }

        .services-hero h1 {
          font-size: 2rem;
        }

        .search-tabs {
          overflow-x: auto;
          width: 100%;
          padding-bottom: 0.5rem;
        }

        .search-tab {
          white-space: nowrap;
          padding: 0.8rem 1rem;
        }

        .modal-content {
          width: 95%;
        }

        .modal-image-gallery img {
          width: 120px;
          height: 80px;
        }

        .reservation-actions {
          flex-direction: column;
        }

        .reservation-actions button {
          width: 100%;
        }

        .login-actions {
          flex-direction: column;
        }

        .login-redirect-btn,
        .login-cancel-btn {
          width: 100%;
        }
      }

      @media (max-width: 480px) {
        .logo a {
          font-size: 1.5rem;
        }

        .logo img {
          width: 40px;
        }

        .auth-button {
          padding: 0.4rem 0.8rem;
          font-size: 0.9rem;
        }

        .services-hero h1 {
          font-size: 1.8rem;
        }

        .section-title {
          font-size: 1.8rem;
        }

        .search-form {
          padding: 1rem;
        }

        .service-card {
          width: 100%;
        }

        .result-actions {
          flex-direction: column;
        }

        .result-button {
          width: 100%;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <div class="logo">
        <img
          src="./images/S_NoBack_500x500.png"
          alt="Saudi Guider logo"
          width="60"
          height="60"
          loading="lazy"
        />
        <a href="index.html" aria-label="Go to Saudi Guider Home"
          >Saudi Guider</a
        >
      </div>

      <button
        class="mobile-nav-toggle"
        aria-label="Toggle navigation menu"
        aria-expanded="false"
        aria-controls="main-nav"
      >
        <i class="fas fa-bars"></i>
      </button>

      <nav id="main-nav" aria-label="Main navigation">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li>
            <a href="services.html" class="active" aria-current="page"
              >Services</a
            >
          </li>
          <li><a href="about.html">About</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>

      <div class="auth-buttons">
        <button onclick="window.location.href='login.html'" aria-label="Log in">
          <i class="fas fa-sign-in-alt"></i> Log In
        </button>
        <button onclick="window.location.href='signup.html'" aria-label="Sign up">
          <i class="fas fa-user-plus"></i> Sign Up
        </button>
      </div>

      <div class="user-dropdown" id="userDropdown" style="display: none;">
        <button class="user-toggle">
          <span id="usernameDisplay"></span>
          <i class="fas fa-caret-down"></i>
        </button>
        <div class="dropdown-menu">
          <a href="profile.html"><i class="fas fa-user"></i> Profile</a>
          <a href="reservations.html"><i class="fas fa-calendar-check"></i> Reservations</a>
          <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Log Out</a>
        </div>
      </div>
    </header>

    <main id="main-content">
      <section class="services-hero" aria-labelledby="services-title">
        <h1 id="services-title">Our Services</h1>
        <p>
          Discover and book the best hotels, restaurants, car rentals, and
          events throughout Saudi Arabia with personalized recommendations.
        </p>
      </section>

      <section
        class="service-categories section"
        aria-labelledby="categories-title"
      >
        <h2 id="categories-title" class="section-title">Featured Services</h2>
        <p class="section-text">
          Explore our most popular services for your Saudi Arabian adventure.
        </p>

        <div class="category-container">
          <div class="service-cards">
            <!-- Hotel Card -->
            <div class="service-card">
              <div class="service-card-image">
                <img
                  src="./images/hotel-exterior.jpg"
                  alt="Luxury Hotel Room"
                  loading="lazy"
                />
              </div>
              <div class="service-card-content">
                <div class="service-card-title">
                  <h3>Luxury Hotel Bookings</h3>
                  <span class="service-price">From $150/night</span>
                </div>
                <p>
                  Book premium hotels across Saudi Arabia with exclusive deals
                  and benefits for Saudi Guider members.
                </p>
                <ul class="service-features">
                  <li>
                    <i class="fas fa-check"></i> Access to 500+ premium hotels
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Exclusive rates and room
                    upgrades
                  </li>
                  <li>
                    <i class="fas fa-check"></i> 24/7 support for all bookings
                  </li>
                </ul>
                <div class="service-card-actions">
                  <button
                    class="view-details-btn"
                    data-service="hotel"
                    aria-label="View details for luxury hotel bookings"
                  >
                    View Details
                  </button>
                  <button
                    class="book-now-btn"
                    aria-label="Book a luxury hotel now"
                  >
                    Book Now
                  </button>
                </div>
              </div>
            </div>

            <!-- Car Rental Card -->
            <div class="service-card">
              <div class="service-card-image">
                <img
                  src="./images/Rent-Luxury-Cars-in-Dubai-1-scaled.jpg"
                  alt="Luxury SUV Rental"
                  loading="lazy"
                />
              </div>
              <div class="service-card-content">
                <div class="service-card-title">
                  <h3>Premium Car Rentals</h3>
                  <span class="service-price">From $75/day</span>
                </div>
                <p>
                  Choose from our fleet of well-maintained vehicles for
                  exploring Saudi Arabia with comfort and convenience.
                </p>
                <ul class="service-features">
                  <li>
                    <i class="fas fa-check"></i> Wide range of vehicles from
                    economy to luxury
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Flexible pickup and drop-off
                    locations
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Comprehensive insurance
                    included
                  </li>
                </ul>
                <div class="service-card-actions">
                  <button
                    class="view-details-btn"
                    data-service="car"
                    aria-label="View details for premium car rentals"
                  >
                    View Details
                  </button>
                  <button class="book-now-btn" aria-label="Rent a car now">
                    Rent Now
                  </button>
                </div>
              </div>
            </div>

            <!-- Restaurant Card -->
            <div class="service-card">
              <div class="service-card-image">
                <img
                  src="./images/reyhana.jpg"
                  alt="Fine Dining Restaurant"
                  loading="lazy"
                />
              </div>
              <div class="service-card-content">
                <div class="service-card-title">
                  <h3>Restaurant Reservations</h3>
                  <span class="service-price">All price ranges</span>
                </div>
                <p>
                  Discover and book the finest dining experiences from
                  traditional Saudi cuisine to international favorites.
                </p>
                <ul class="service-features">
                  <li>
                    <i class="fas fa-check"></i> Access to exclusive restaurants
                    and private dining
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Special Saudi Guider menu
                    options at select venues
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Dietary preferences
                    accommodated
                  </li>
                </ul>
                <div class="service-card-actions">
                  <button
                    class="view-details-btn"
                    data-service="restaurant"
                    aria-label="View details for restaurant reservations"
                  >
                    View Details
                  </button>
                  <button
                    class="book-now-btn"
                    aria-label="Book a restaurant now"
                  >
                    Reserve Now
                  </button>
                </div>
              </div>
            </div>

            <!-- Event Card -->
            <div class="service-card">
              <div class="service-card-image">
                <img
                  src="./images/2-your-ultimate-guide-to-riyadh-season-2023.jpg"
                  alt="Cultural Festival Event"
                  loading="lazy"
                />
              </div>
              <div class="service-card-content">
                <div class="service-card-title">
                  <h3>Cultural & Entertainment Events</h3>
                  <span class="service-price">From $25/ticket</span>
                </div>
                <p>
                  Get tickets for the most popular cultural festivals, concerts,
                  sports events, and exhibitions across Saudi Arabia.
                </p>
                <ul class="service-features">
                  <li>
                    <i class="fas fa-check"></i> Priority access to sold-out
                    events
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Exclusive Saudi Guider member
                    discounts
                  </li>
                  <li>
                    <i class="fas fa-check"></i> Group booking options available
                  </li>
                </ul>
                <div class="service-card-actions">
                  <button
                    class="view-details-btn"
                    data-service="event"
                    aria-label="View details for cultural and entertainment events"
                  >
                    View Details
                  </button>
                  <button
                    class="book-now-btn"
                    aria-label="Book event tickets now"
                  >
                    Get Tickets
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section
        class="search-section section"
        aria-labelledby="search-section-title"
      >
        <h2 id="search-section-title" class="section-title">
          Find What You Need
        </h2>
        <p class="section-text">
          Use our search tools to find exactly what you're looking for based on your preferences.
        </p>

        <div class="search-container">
          <div class="search-tabs" role="tablist">
            <button
              class="search-tab active"
              data-tab="hotels"
              role="tab"
              aria-selected="true"
              aria-controls="hotel-search"
            >
              <i class="fas fa-hotel"></i> Hotels
            </button>
            <button
              class="search-tab"
              data-tab="restaurants"
              role="tab"
              aria-selected="false"
              aria-controls="restaurant-search"
            >
              <i class="fas fa-utensils"></i> Restaurants
            </button>
            <button
              class="search-tab"
              data-tab="cars"
              role="tab"
              aria-selected="false"
              aria-controls="car-search"
            >
              <i class="fas fa-car"></i> Car Rentals
            </button>
            <button
              class="search-tab"
              data-tab="events"
              role="tab"
              aria-selected="false"
              aria-controls="event-search"
            >
              <i class="fas fa-ticket-alt"></i> Events
            </button>
          </div>
            <div class="fetch-all-container" style="text-align: center; margin: 1rem 0;">
  <button id="fetchAllBtn" class="search-button">
    <i class="fas fa-list"></i> Show All Services
  </button>
</div>
          <form
            class="search-form"
            id="hotel-search"
            role="tabpanel"
            aria-labelledby="hotels"
          >
            <div class="form-group">
              <label for="destination">Destination</label>
              <input
                type="text"
                id="destination"
                placeholder="City or region"
                required
                aria-required="true"
              />
            </div>
            <div class="form-group">
              <label for="check-in">Check-in</label>
              <input type="date" id="check-in" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="check-out">Check-out</label>
              <input type="date" id="check-out" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="guests">Guests</label>
              <select id="guests" required aria-required="true">
                <option value="1">1 Guest</option>
                <option value="2" selected>2 Guests</option>
                <option value="3">3 Guests</option>
                <option value="4">4 Guests</option>
                <option value="5">5+ Guests</option>
              </select>
            </div>
            <div class="form-group">
              <label for="price-range">Price Range</label>
              <select id="price-range">
                <option value="all">Any Price</option>
                <option value="0-100">Under 100 SAR</option>
                <option value="100-300">100-300 SAR</option>
                <option value="300-500">300-500 SAR</option>
                <option value="500-1000">500-1000 SAR</option>
                <option value="1000+">Over 1000 SAR</option>
              </select>
            </div>
            <div class="form-group">
              <label for="min-rating">Minimum Rating</label>
              <select id="min-rating">
                <option value="0">Any Rating</option>
                <option value="3">3+ Stars</option>
                <option value="4">4+ Stars</option>
                <option value="4.5">4.5+ Stars</option>
              </select>
            </div>
            <div class="form-group">
              <label for="amenities">Amenities</label>
              <select id="amenities" multiple>
                <option value="Free WiFi">Free WiFi</option>
                <option value="parking">Free Parking</option>
                <option value="pool">Swimming Pool</option>
                <option value="gym">Fitness Center</option>
                <option value="breakfast">Free Breakfast</option>
              </select>
            </div>
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i> Search
            </button>
          </form>

          <form
            class="search-form"
            id="restaurant-search"
            role="tabpanel"
            aria-labelledby="restaurants"
            style="display: none;"
          >
            <div class="form-group">
              <label for="restaurant-destination">Destination</label>
              <input
                type="text"
                id="restaurant-destination"
                placeholder="City or region"
                required
                aria-required="true"
              />
            </div>
            <div class="form-group">
              <label for="restaurant-date">Date</label>
              <input type="date" id="restaurant-date" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="restaurant-guests">Guests</label>
              <select id="restaurant-guests" required aria-required="true">
                <option value="1">1 Guest</option>
                <option value="2" selected>2 Guests</option>
                <option value="3">3 Guests</option>
                <option value="4">4 Guests</option>
                <option value="5">5+ Guests</option>
              </select>
            </div>
            <div class="form-group">
              <label for="restaurant-price-range">Price Range</label>
              <select id="restaurant-price-range">
                <option value="all">Any Price</option>
                <option value="0-100">Under 100 SAR</option>
                <option value="100-300">100-300 SAR</option>
                <option value="300-500">300-500 SAR</option>
                <option value="500-1000">500-1000 SAR</option>
                <option value="1000+">Over 1000 SAR</option>
              </select>
            </div>
            <div class="form-group">
              <label for="restaurant-min-rating">Minimum Rating</label>
              <select id="restaurant-min-rating">
                <option value="0">Any Rating</option>
                <option value="3">3+ Stars</option>
                <option value="4">4+ Stars</option>
                <option value="4.5">4.5+ Stars</option>
              </select>
            </div>
            <div class="form-group">
              <label for="restaurant-categories">Categories</label>
              <select id="restaurant-categories" multiple>
                <option value="arabic">Arabic</option>
                <option value="international">International</option>
                <option value="seafood">Seafood</option>
                <option value="steakhouse">Steakhouse</option>
                <option value="vegetarian">Vegetarian</option>
              </select>
            </div>
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i> Search
            </button>
          </form>

          <form
            class="search-form"
            id="car-search"
            role="tabpanel"
            aria-labelledby="cars"
            style="display: none;"
          >
            <div class="form-group">
              <label for="car-destination">Pickup Location</label>
              <input
                type="text"
                id="car-destination"
                placeholder="City or region"
                required
                aria-required="true"
              />
            </div>
            <div class="form-group">
              <label for="car-pickup-date">Pickup Date</label>
              <input type="date" id="car-pickup-date" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="car-dropoff-date">Dropoff Date</label>
              <input type="date" id="car-dropoff-date" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="car-price-range">Price Range</label>
              <select id="car-price-range">
                <option value="all">Any Price</option>
                <option value="0-100">Under 100 SAR</option>
                <option value="100-300">100-300 SAR</option>
                <option value="300-500">300-500 SAR</option>
                <option value="500-1000">500-1000 SAR</option>
                <option value="1000+">Over 1000 SAR</option>
              </select>
            </div>
            <div class="form-group">
              <label for="car-min-rating">Minimum Rating</label>
              <select id="car-min-rating">
                <option value="0">Any Rating</option>
                <option value="3">3+ Stars</option>
                <option value="4">4+ Stars</option>
                <option value="4.5">4.5+ Stars</option>
              </select>
            </div>
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i> Search
            </button>
          </form>

          <form
            class="search-form"
            id="event-search"
            role="tabpanel"
            aria-labelledby="events"
            style="display: none;"
          >
            <div class="form-group">
              <label for="event-destination">Destination</label>
              <input
                type="text"
                id="event-destination"
                placeholder="City or region"
                required
                aria-required="true"
              />
            </div>
            <div class="form-group">
              <label for="event-date">Date</label>
              <input type="date" id="event-date" required aria-required="true" />
            </div>
            <div class="form-group">
              <label for="event-tickets">Tickets</label>
              <select id="event-tickets" required aria-required="true">
                <option value="1">1 Ticket</option>
                <option value="2" selected>2 Tickets</option>
                <option value="3">3 Tickets</option>
                <option value="4">4 Tickets</option>
                <option value="5">5+ Tickets</option>
              </select>
            </div>
            <div class="form-group">
              <label for="event-price-range">Price Range</label>
              <select id="event-price-range">
                <option value="all">Any Price</option>
                <option value="0-100">Under 100 SAR</option>
                <option value="100-300">100-300 SAR</option>
                <option value="300-500">300-500 SAR</option>
                <option value="500-1000">500-1000 SAR</option>
                <option value="1000+">Over 1000 SAR</option>
              </select>
            </div>
            <div class="form-group">
              <label for="event-categories">Categories</label>
              <select id="event-categories" multiple>
                <option value="concert">Concerts</option>
                <option value="sports">Sports</option>
                <option value="cultural">Cultural</option>
                <option value="festival">Festivals</option>
                <option value="family">Family</option>
              </select>
            </div>
            <button type="submit" class="search-button">
              <i class="fas fa-search"></i> Search
            </button>
          </form>

          <div id="search-results" class="search-results">
            <div class="sort-controls">
                <div class="sort-options">
                    <label for="sort-by">Sort by:</label>
                    <select id="sort-by">
                        <option value="recommended">Recommended</option>
                        <option value="price-low">Price (Low to High)</option>
                        <option value="price-high">Price (High to Low)</option>
                        <option value="rating">Rating</option>
                        <option value="name">Name (A-Z)</option>
                    </select>
                </div>
                <div class="results-count">0 results found</div>
            </div>
            
            <div id="results-container" class="results-grid">
              <!-- Results will be inserted here by JavaScript -->
            </div>
          </div>
        </div>
      </section>

      <!-- Service Detail Modals -->
      <!-- Hotel Details Modal -->
      <div
        id="hotelModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="hotelModalTitle"
      >
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="hotelModalTitle" class="modal-title">
              Luxury Hotel Bookings
            </h3>
            <button class="close-modal" aria-label="Close modal">
              &times;
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-details">
              <div class="modal-info">
                <h4>Service Details</h4>
                <p>
                  Our hotel booking service provides access to the finest
                  accommodations across Saudi Arabia, from boutique hotels to
                  luxury resorts. With Saudi Guider, you'll enjoy exclusive
                  member rates and special amenities.
                </p>

                <h4>Price Information</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Economy:
                    $80-150/night
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Premium:
                    $150-300/night
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Luxury:
                    $300-800+/night
                  </li>
                  <li>
                    <i class="fas fa-tag"></i> Members receive up to a 15%
                    discount
                  </li>
                </ul>
              </div>

              <div class="modal-features">
                <h4>Features & Benefits</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-star"></i> Access to over 500 premium
                    hotels throughout Saudi Arabia
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Best price guarantee and price
                    match policy
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Exclusive room upgrades when
                    available
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Special welcome amenities at
                    partner hotels
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Flexible cancellation policies
                  </li>
                  <li>
                    <i class="fas fa-star"></i> 24/7 customer support for all
                    bookings
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Earn loyalty points with every
                    booking
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="auth-button">Book Now</button>
          </div>
        </div>
      </div>

      <!-- Car Rental Details Modal -->
      <div
        id="carModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="carModalTitle"
      >
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="carModalTitle" class="modal-title">Premium Car Rentals</h3>
            <button class="close-modal" aria-label="Close modal">
              &times;
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-details">
              <div class="modal-info">
                <h4>Service Details</h4>
                <p>
                  Our car rental service provides well-maintained vehicles from
                  trusted providers across Saudi Arabia. From economy cars to
                  luxury SUVs, we have options for every need and budget. All
                  rentals include comprehensive insurance.
                </p>

                <h4>Price Information</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Economy: $40-75/day
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Mid-size: $75-150/day
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Luxury: $150-300+/day
                  </li>
                  <li>
                    <i class="fas fa-tag"></i> Weekly rental discounts up to 25%
                  </li>
                </ul>
              </div>

              <div class="modal-features">
                <h4>Features & Benefits</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-star"></i> Wide range of vehicles from
                    economy to luxury
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Flexible pickup and drop-off
                    locations
                  </li>
                  <li><i class="fas fa-star"></i> No hidden fees or charges</li>
                  <li>
                    <i class="fas fa-star"></i> Comprehensive insurance included
                  </li>
                  <li>
                    <i class="fas fa-star"></i> 24/7 roadside assistance
                    throughout Saudi Arabia
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Optional GPS navigation and
                    child seats
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Fuel options and mileage
                    packages available
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="auth-button">Rent Now</button>
          </div>
        </div>
      </div>

      <!-- Restaurant Details Modal -->
      <div
        id="restaurantModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="restaurantModalTitle"
      >
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="restaurantModalTitle" class="modal-title">
              Restaurant Reservations
            </h3>
            <button class="close-modal" aria-label="Close modal">
              &times;
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-details">
              <div class="modal-info">
                <h4>Service Details</h4>
                <p>
                  Discover and book the best dining experiences across Saudi
                  Arabia with our restaurant reservation service. From authentic
                  Saudi cuisine to international fine dining, we help you secure
                  tables at the most popular and exclusive restaurants.
                </p>

                <h4>Price Information</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Casual Dining: $15-40
                    per person
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Mid-range: $40-80 per
                    person
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Fine Dining: $80-200+
                    per person
                  </li>
                  <li>
                    <i class="fas fa-tag"></i> Special tasting menus available
                    at select restaurants
                  </li>
                </ul>
              </div>

              <div class="modal-features">
                <h4>Features & Benefits</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-star"></i> Access to exclusive restaurants
                    and private dining experiences
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Special Saudi Guider menu
                    options at select venues
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Priority reservations even
                    during peak times
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Dietary preferences and
                    restrictions accommodated
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Insider recommendations from
                    local food experts
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Reviews and ratings from
                    verified Saudi Guider members
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Group booking options for
                    special occasions
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="auth-button">Reserve Now</button>
          </div>
        </div>
      </div>

      <!-- Event Details Modal -->
      <div
        id="eventModal"
        class="modal"
        role="dialog"
        aria-modal="true"
        aria-labelledby="eventModalTitle"
      >
        <div class="modal-content">
          <div class="modal-header">
            <h3 id="eventModalTitle" class="modal-title">
              Cultural & Entertainment Events
            </h3>
            <button class="close-modal" aria-label="Close modal">
              &times;
            </button>
          </div>
          <div class="modal-body">
            <div class="modal-details">
              <div class="modal-info">
                <h4>Service Details</h4>
                <p>
                  Get tickets to the most popular cultural festivals, concerts,
                  sports events, and exhibitions across Saudi Arabia. Our event
                  service provides access to both mainstream and exclusive
                  experiences, with options for every interest.
                </p>

                <h4>Price Information</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Cultural Experiences:
                    $25-75 per ticket
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Concerts & Shows:
                    $50-200+ per ticket
                  </li>
                  <li>
                    <i class="fas fa-money-bill-wave"></i> Sports Events:
                    $30-150 per ticket
                  </li>
                  <li>
                    <i class="fas fa-tag"></i> VIP packages available for select
                    events
                  </li>
                </ul>
              </div>

              <div class="modal-features">
                <h4>Features & Benefits</h4>
                <ul class="detail-list">
                  <li>
                    <i class="fas fa-star"></i> Priority access to sold-out
                    events
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Exclusive Saudi Guider member
                    discounts
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Early access to ticket sales for
                    major events
                  </li>
                  <li>
                    <i class="fas fa-star"></i> VIP upgrades and exclusive
                    experiences
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Group booking options available
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Last-minute ticket availability
                  </li>
                  <li>
                    <i class="fas fa-star"></i> Event recommendations based on
                    your preferences
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button class="auth-button">Get Tickets</button>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <div class="footer-content">
        <div class="footer-section">
          <h3>Saudi Guider</h3>
          <p>
            Your ultimate companion for exploring Saudi Arabia with personalized
            recommendations.
          </p>
          <div class="social-icons">
            <a href="#" aria-label="Follow us on Twitter"
              ><i class="fab fa-twitter" aria-hidden="true"></i
            ></a>
            <a
              href="https://www.instagram.com/saudi_guider?igsh=OGFoY3k0d2N5dDM="
              aria-label="Follow us on Instagram"
              ><i class="fab fa-instagram" aria-hidden="true"></i
            ></a>
          </div>
        </div>
        <div class="footer-section">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="services.html">Services</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Explore Saudi Arabia</h3>
          <ul>
            <li><a href="#popular-destinations">Popular Destinations</a></li>
            <li><a href="#travel-guides">Travel Guides</a></li>
            <li><a href="#cultural-experiences">Cultural Experiences</a></li>
            <li><a href="#travel-tips">Travel Tips</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h3>Contact Us</h3>
          <address>
            <p>
              <i class="fas fa-map-marker-alt" aria-hidden="true"></i> Jeddah,
              Saudi Arabia
            </p>
            <p>
              <i class="fas fa-phone" aria-hidden="true"></i>
              <a href="tel:+966556294862">+966 55 629 4862</a>
            </p>
            <p>
              <i class="fas fa-envelope" aria-hidden="true"></i>
              <a href="mailto:saudiguider1@gmail.com">saudiguider1@gmail.com</a>
            </p>
          </address>
        </div>
      </div>
      <div class="footer-bottom">
        <p>
          &copy; <span id="current-year">2025</span> Saudi Guider. All rights
          reserved.
        </p>
      </div>
    </footer>

<script>
  // API Configuration
  const API_BASE_URL = 'https://saudiguiderbackend.onrender.com/api';

  // Enhanced error display
 function showErrorToUser(message, duration = 5000) {
  const existing = document.getElementById('booking-error');
  if (existing) existing.remove();

  // Special handling for date errors
  if (message.includes('Start date must be in the future') || 
      message.includes('End date must be after start date')) {
    message = 'Please select future dates for your reservation. ' + message;
    
    // Highlight date inputs
    document.querySelectorAll('#check-in, #check-out, #car-pickup-date, #car-dropoff-date, [id$="-date"]').forEach(input => {
      input.style.border = '1px solid #ff0000';
      setTimeout(() => input.style.border = '', 3000);
    });
  }

  const errorEl = document.createElement('div');
  errorEl.id = 'booking-error';
  errorEl.innerHTML = `
    <div class="error-content">
      <i class="fas fa-exclamation-triangle"></i>
      <h4>Booking Error</h4>
      <p>${message}</p>
      ${message.includes('already have a reservation') ? 
        '<a href="reservations.html">View Existing Reservations</a>' : ''}
    </div>
  `;
  document.body.appendChild(errorEl);

  setTimeout(() => {
    errorEl.style.opacity = '0';
    setTimeout(() => errorEl.remove(), 300);
  }, duration);
}

  // Success message display
  function showSuccessMessage(message, duration = 3000) {
    const existing = document.querySelector('.success-message');
    if (existing) existing.remove();

    const successEl = document.createElement('div');
    successEl.className = 'success-message';
    successEl.innerHTML = `
      <div class="success-content">
        <i class="fas fa-check-circle"></i>
        <p>${message}</p>
      </div>
    `;
    document.body.appendChild(successEl);

    setTimeout(() => {
      successEl.style.opacity = '0';
      setTimeout(() => successEl.remove(), 300);
    }, duration);
  }

  function setupSorting() {
    const sortSelect = document.getElementById('sort-by');
    if (sortSelect) {
      sortSelect.addEventListener('change', function() {
        const activeForm = document.querySelector('.search-form[style="display: flex;"]') || 
                          document.querySelector('.search-form:not([style*="none"])');
        const selectedValue = this.value;
        
        if (activeForm) {
          applySorting(selectedValue);
        } else {
          applySorting(selectedValue);
        }
        
        this.value = selectedValue;
      });
    }
  }

  const typeMap = {
    'hotels': 'hotel',
    'restaurants': 'restaurant',
    'cars': 'car',
    'events': 'event'
  };

  function logError(context, error, extra = {}) {
    console.groupCollapsed(` Error in ${context}`);
    console.error('Error:', error);
    console.log('Error details:', {
      message: error.message,
      stack: error.stack,
      ...extra
    });
    console.groupEnd();
  }

  function getElement(id, context = '') {
    try {
      const el = document.getElementById(id);
      if (!el) {
        const error = new Error(`Element with ID "${id}" not found`);
        logError(`getElement${context ? ` (${context})` : ''}`, error, { elementId: id });
        return null;
      }
      return el;
    } catch (error) {
      logError(`getElement${context ? ` (${context})` : ''}`, error, { elementId: id });
      return null;
    }
  }

  async function fetchAllServices() {
    try {
      const searchResults = document.getElementById('search-results');
      const resultsContainer = document.getElementById('results-container');
      
      if (searchResults) {
        searchResults.innerHTML = `
          <div class="loading-state">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Loading all services...</p>
          </div>
        `;
        searchResults.classList.add('active');
      }

      if (resultsContainer) resultsContainer.innerHTML = '';

      const response = await fetch(`${API_BASE_URL}/services/all`);
      
      if (!response.ok) throw new Error(`Server error: ${response.status}`);
      
      const data = await response.json();
      
      if (!data || typeof data !== 'object') {
        throw new Error('Invalid API response format');
      }

      if (data.data && data.data.length > 0) {
        const groupedServices = data.data.reduce((acc, service) => {
          if (!acc[service.type]) acc[service.type] = [];
          acc[service.type].push(service);
          return acc;
        }, {});

        let resultsHTML = '';
        for (const [type, services] of Object.entries(groupedServices)) {
          resultsHTML += `
            <div class="service-type-group">
              <h3 class="service-type-title">${type.charAt(0).toUpperCase() + type.slice(1)}s</h3>
              <div class="results-grid" id="results-${type}"></div>
            </div>
          `;
        }

        if (searchResults) {
          searchResults.innerHTML = `
            <div class="sort-controls">
              <div class="sort-options">
                <label for="sort-by">Sort by:</label>
                <select id="sort-by">
                  <option value="recommended">Recommended</option>
                  <option value="price-low">Price (Low to High)</option>
                  <option value="price-high">Price (High to Low)</option>
                  <option value="rating">Rating</option>
                  <option value="name-asc">Name (A-Z)</option>
                </select>
              </div>
              <div class="results-count">${data.data.length} total services found</div>
            </div>
            ${resultsHTML}
          `;
        }

        for (const [type, services] of Object.entries(groupedServices)) {
          displaySearchResults({ data: services }, type);
        }
      } else {
        searchResults.innerHTML = `
          <div class="no-results">
            <i class="fas fa-search"></i>
            <h4>No services found</h4>
            <p>Try again later</p>
          </div>
        `;
      }
    } catch (error) {
      console.error('Fetch all failed:', error);
      const searchResults = document.getElementById('search-results');
      if (searchResults) {
        searchResults.innerHTML = `
          <div class="error-state">
            <i class="fas fa-exclamation-triangle"></i>
            <h4>Failed to load services</h4>
            <p>${error.message || 'Please try again later'}</p>
            <button onclick="fetchAllServices()" class="retry-btn">Try Again</button>
          </div>
        `;
      }
    }
  }

  function displaySearchResults(data, type) {
    try {
      const services = Array.isArray(data) ? data : (data.data || []);
      let resultsContainer = document.getElementById(`results-${type}`) || 
                           document.getElementById('results-container');
      
      if (!resultsContainer) throw new Error('Results container not found');

      resultsContainer.innerHTML = '';

      if (services.length === 0) {
        resultsContainer.innerHTML = `
          <div class="no-results">
            <i class="fas fa-search"></i>
            <h4>No ${type} found</h4>
          </div>
        `;
        return;
      }

      services.forEach((service) => {
        const resultItem = document.createElement('div');
        resultItem.className = 'result-item';
        
        const title = service.title || service.name || 'Untitled Service';
        const location = service.location || service.city || 'Location not specified';
        const price = service.price ? `${service.price} SAR` : 'Price not available';
        const rating = service.rating ? `${''.repeat(Math.round(service.rating))} (${service.rating.toFixed(1)})` : 'No ratings';
        
        const amenitiesHTML = service.amenities && service.amenities.length > 0 
          ? `<div class="amenities">${service.amenities.slice(0, 3).map(a => 
              `<span class="amenity-tag">${a}</span>`).join('')}</div>`
          : '';

        resultItem.innerHTML = `
          <div class="result-image">
            <i class="fas ${service.icon || getIconForType(type)}"></i>
          </div>
          <div class="result-details">
            <h3>${title}</h3>
            <p class="location"><i class="fas fa-map-marker-alt"></i> ${location}</p>
            <p class="price">${price}</p>
            <p class="rating">${rating}</p>
            ${amenitiesHTML}
            <button class="book-btn" data-id="${service._id || service.id}" data-type="${type}">
              Book Now
            </button>
          </div>
        `;

        resultsContainer.appendChild(resultItem);
      });

      setupSorting();
    } catch (error) {
      console.error('Error displaying results:', error);
      const resultsContainer = document.getElementById('results-container') || document.body;
      resultsContainer.innerHTML = `
        <div class="error-state">
          <i class="fas fa-exclamation-triangle"></i>
          <h4>Error Displaying Results</h4>
          <p>${error.message}</p>
        </div>
      `;
    }
  }

  function applySorting(sortOption, resultsContainer) {
    if (!resultsContainer) {
      resultsContainer = document.getElementById('results-container') || 
                       document.querySelector('.results-grid');
    }
    
    if (!resultsContainer) return;
    
    const resultItems = Array.from(resultsContainer.querySelectorAll('.result-item'));
    
    resultItems.sort((a, b) => {
      const aPrice = parsePrice(a.querySelector('.price').textContent);
      const bPrice = parsePrice(b.querySelector('.price').textContent);
      const aRating = parseRating(a.querySelector('.rating').textContent);
      const bRating = parseRating(b.querySelector('.rating').textContent);
      const aTitle = a.querySelector('h3').textContent.toLowerCase();
      const bTitle = b.querySelector('h3').textContent.toLowerCase();

      switch(sortOption) {
        case 'price-low': return aPrice - bPrice;
        case 'price-high': return bPrice - aPrice;
        case 'rating': return bRating - aRating;
        case 'name-asc': return aTitle.localeCompare(bTitle);
        case 'name-desc': return bTitle.localeCompare(aTitle);
        default: return 0;
      }
    });

    resultsContainer.innerHTML = '';
    resultItems.forEach(item => resultsContainer.appendChild(item));
    
    const sortSelect = document.getElementById('sort-by');
    if (sortSelect) sortSelect.value = sortOption;
  }

  function parsePrice(priceText) {
    return parseFloat(priceText.replace(/[^0-9.]/g, '')) || 0;
  }

  function parseRating(ratingText) {
    return parseFloat(ratingText.match(/\d+(\.\d+)?/)?.[0]) || 0;
  }

  function getIconForType(type) {
    const icons = {
      hotel: 'fa-hotel',
      restaurant: 'fa-utensils',
      car: 'fa-car',
      event: 'fa-ticket-alt'
    };
    return icons[type] || 'fa-star';
  }

  async function handleSearchFormSubmit(e) {
    e.preventDefault();
    const form = e.target;
    const activeTab = document.querySelector('.search-tab.active')?.dataset.tab;
    const serviceType = typeMap[activeTab];
    
    try {
      const searchResults = document.getElementById('search-results');
      const resultsContainer = document.getElementById('results-container');
      
      if (searchResults) {
        searchResults.innerHTML = `
          <div class="loading-state">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Searching for ${activeTab}...</p>
          </div>
        `;
        searchResults.classList.add('active');
      }

      if (resultsContainer) resultsContainer.innerHTML = '';

      const params = new URLSearchParams();
      params.append('type', serviceType);

      const location = form.querySelector('[id*="destination"]')?.value?.trim();
      if (location) params.append('location', location);

      if (serviceType === 'hotel') {
        const checkIn = form.querySelector('#check-in')?.value;
        const checkOut = form.querySelector('#check-out')?.value;
        if (checkIn) params.append('startDate', checkIn);
        if (checkOut) params.append('endDate', checkOut);
      } else if (serviceType === 'car') {
        const pickupDate = form.querySelector('#car-pickup-date')?.value;
        const dropoffDate = form.querySelector('#car-dropoff-date')?.value;
        if (pickupDate) params.append('startDate', pickupDate);
        if (dropoffDate) params.append('endDate', dropoffDate);
      } else {
        const date = form.querySelector('[id*="date"]')?.value;
        if (date) params.append('startDate', date);
      }

      const capacityInput = form.querySelector('[id*="guests"], [id*="tickets"]');
      if (capacityInput?.value) params.append('capacity', capacityInput.value);

      const priceRange = form.querySelector('[id*="price-range"]')?.value;
      if (priceRange && priceRange !== 'all') {
        const [minPrice, maxPrice] = priceRange.split('-').map(Number);
        if (!isNaN(minPrice)) params.append('minPrice', minPrice);
        if (!isNaN(maxPrice)) params.append('maxPrice', maxPrice);
      }

      const minRating = form.querySelector('[id*="min-rating"]')?.value;
      if (minRating && minRating !== '0') params.append('rating', minRating);

      const amenitiesSelect = form.querySelector('[id*="amenities"], [id*="categories"]');
      if (amenitiesSelect) {
        const selectedOptions = Array.from(amenitiesSelect.selectedOptions)
          .map(option => option.value)
          .filter(val => val);
        if (selectedOptions.length) params.append('amenities', selectedOptions.join(','));
      }
      
      const sortSelect = document.getElementById('sort-by');
      const sortBy = sortSelect ? sortSelect.value : 'recommended';
      params.append('sort', sortBy);
      
      const apiUrl = `${API_BASE_URL}/services?${params.toString()}`;
      console.log('API Request:', apiUrl);
      
      const response = await fetch(apiUrl);
      if (!response.ok) throw new Error(`Server error: ${response.status}`);
      
      const data = await response.json();
      if (!data || typeof data !== 'object') throw new Error('Invalid API response format');

      if (data.data?.length > 0) {
        if (searchResults) {
          searchResults.innerHTML = `
            <div class="sort-controls">
              <div class="sort-options">
                <label for="sort-by">Sort by:</label>
                <select id="sort-by">
                  <option value="recommended">Recommended</option>
                  <option value="price-low">Price (Low to High)</option>
                  <option value="price-high">Price (High to Low)</option>
                  <option value="rating">Rating</option>
                  <option value="name-asc">Name (A-Z)</option>
                </select>
              </div>
              <div class="results-count">${data.data.length} results found</div>
            </div>
            <div id="results-container" class="results-grid"></div>
          `;
          
          if (sortSelect) document.getElementById('sort-by').value = sortBy;
        }
        displaySearchResults(data, serviceType);
      } else {
        searchResults.innerHTML = `
          <div class="no-results">
            <i class="fas fa-search"></i>
            <h4>No ${activeTab} found</h4>
            <p>Try adjusting your search criteria</p>
          </div>
        `;
      }
    } catch (error) {
      console.error('Search failed:', error);
      const searchResults = document.getElementById('search-results');
      if (searchResults) {
        searchResults.innerHTML = `
          <div class="error-state">
            <i class="fas fa-exclamation-triangle"></i>
            <h4>Search Failed</h4>
            <p>${error.message || 'Please try again later'}</p>
            <button onclick="retrySearch()" class="retry-btn">Try Again</button>
          </div>
        `;
      }
    }
  }

  window.retrySearch = function() {
    const activeForm = document.querySelector('.search-form[style="display: flex;"]') || 
                      document.querySelector('.search-form');
    if (activeForm) activeForm.dispatchEvent(new Event('submit'));
  };

  async function handleReservation(serviceId, serviceType, event) {
  const button = event.target.closest('.book-btn');
  const originalText = button.innerHTML;
  
  try {
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';

    const { startDate, endDate } = getReservationDates(serviceType);
    
    if (!serviceId || !startDate || !endDate) {
      throw new Error('Please complete all required fields');
    }

    const response = await fetch(`${API_BASE_URL}/reservations`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${localStorage.getItem('token')}`
      },
      body: JSON.stringify({
        serviceId,
        serviceType,
        startDate,
        endDate,
        guests: 1 // Add default guests if needed
      })
    });

    const data = await response.json();
    
    if (!response.ok) {
      // More detailed error messages
      let errorMsg = data.message || 'Booking failed';
      if (response.status === 400) {
        errorMsg = data.message || 'Invalid request data';
      } else if (response.status === 500) {
        errorMsg = 'Server error, please try again later';
      }
      throw new Error(errorMsg);
    }

    showBookingSuccess();
    if (window.location.pathname.includes('reservations.html')) {
      await displayUserReservations();
    } else {
      await updateReservationCount();
    }
    
    return true;
  } catch (error) {
    console.error('Full reservation error:', {
      error: error.message,
      serviceId,
      serviceType
    });
    
    let userMessage = error.message;
    if (error.message.includes('already have a reservation')) {
      userMessage += '. Please check your existing reservations.';
    }
    
    showErrorToUser(userMessage);
    return false;
  } finally {
    button.disabled = false;
    button.innerHTML = originalText;
  }
}

 function getReservationDates(serviceType) {
  const now = new Date();
  const tomorrow = new Date();
  tomorrow.setDate(now.getDate() + 1);

  const formatForInput = (date) => date.toISOString().split('T')[0];
  const formatForAPI = (date) => date.toISOString();

  switch(serviceType) {
    case 'hotel':
      const checkIn = document.getElementById('check-in');
      const checkOut = document.getElementById('check-out');
      
      // Set minimum dates if not set
      if (checkIn && !checkIn.value) {
        checkIn.value = formatForInput(now);
        checkIn.min = formatForInput(now);
      }
      if (checkOut && !checkOut.value) {
        checkOut.value = formatForInput(tomorrow);
        checkOut.min = formatForInput(tomorrow);
      }
      
      return {
        startDate: checkIn?.value ? formatForAPI(new Date(checkIn.value)) : formatForAPI(tomorrow),
        endDate: checkOut?.value ? formatForAPI(new Date(checkOut.value)) : formatForAPI(new Date(tomorrow.getTime() + 86400000))
      };
      
    case 'car':
      const pickupDate = document.getElementById('car-pickup-date');
      const dropoffDate = document.getElementById('car-dropoff-date');
      
      if (pickupDate && !pickupDate.value) {
        pickupDate.value = formatForInput(now);
        pickupDate.min = formatForInput(now);
      }
      if (dropoffDate && !dropoffDate.value) {
        dropoffDate.value = formatForInput(tomorrow);
        dropoffDate.min = formatForInput(tomorrow);
      }
      
      return {
        startDate: pickupDate?.value ? formatForAPI(new Date(pickupDate.value)) : formatForAPI(now),
        endDate: dropoffDate?.value ? formatForAPI(new Date(dropoffDate.value)) : formatForAPI(tomorrow)
      };
      
    default:
      const dateInput = document.querySelector(`#${serviceType}-date`);
      if (dateInput && !dateInput.value) {
        dateInput.value = formatForInput(now);
        dateInput.min = formatForInput(now);
      }
      
      const selectedDate = dateInput?.value ? new Date(dateInput.value) : now;
      return {
        startDate: formatForAPI(selectedDate),
        endDate: formatForAPI(new Date(selectedDate.getTime() + 86400000))
      };
  }
}

  function showBookingSuccess() {
    const existingMsg = document.querySelector('.booking-message');
    if (existingMsg) existingMsg.remove();

    const successMsg = document.createElement('div');
    successMsg.className = 'booking-message success';
    successMsg.innerHTML = `
      <div class="message-content">
        <i class="fas fa-check-circle"></i>
        <div>
          <h4>Reservation Confirmed!</h4>
          <p>Your booking was successful.</p>
        </div>
        <button class="close-message">&times;</button>
      </div>
      <div class="message-actions">
        <button onclick="window.location.href='reservations.html'">
          View My Reservations
        </button>
      </div>
    `;

    document.body.appendChild(successMsg);

    successMsg.querySelector('.close-message').addEventListener('click', () => {
      successMsg.remove();
    });

    setTimeout(() => {
      successMsg.style.opacity = '0';
      setTimeout(() => successMsg.remove(), 300);
    }, 5000);
  }

  async function displayUserReservations() {
    const container = document.getElementById('reservations-container');
    if (!container) return;

    try {
      container.innerHTML = `
        <div class="loading-state">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading your reservations...</p>
        </div>
      `;

      const token = localStorage.getItem('token');
      if (!token) {
        window.location.href = 'login.html';
        return;
      }

      const response = await fetch(`${API_BASE_URL}/reservations`, {
        headers: { 'Authorization': `Bearer ${token}` }
      });

      if (!response.ok) throw new Error('Failed to load reservations');

      const { data: reservations } = await response.json();

      if (!reservations || reservations.length === 0) {
        container.innerHTML = `
          <div class="no-reservations">
            <i class="fas fa-calendar-times"></i>
            <h3>No Reservations Found</h3>
            <p>You haven't made any reservations yet.</p>
            <button onclick="window.location.href='services.html'">
              Book Now
            </button>
          </div>
        `;
        return;
      }

      container.innerHTML = `
        <h2>My Reservations</h2>
        <div class="reservations-list">
          ${reservations.map(reservation => `
            <div class="reservation-card" data-id="${reservation._id}">
              <div class="reservation-header">
                <h3>${reservation.service?.title || 'Unknown Service'}</h3>
                <span class="status-badge ${reservation.status}">
                  ${reservation.status}
                  ${reservation.isActive ? ' (Active)' : ''}
                </span>
              </div>
              
              <div class="reservation-image">
                <i class="fas ${reservation.service?.icon || 'fa-image'}"></i>
              </div>
              
              <div class="reservation-details">
                <p><i class="fas fa-calendar-alt"></i> ${formatDate(reservation.startDate)} - ${formatDate(reservation.endDate)}</p>
                <p><i class="fas fa-clock"></i> ${reservation.durationDays} ${reservation.durationDays === 1 ? 'day' : 'days'}</p>
                <p><i class="fas fa-map-marker-alt"></i> ${reservation.service?.location || 'Location not specified'}</p>
                <p><i class="fas fa-tag"></i> ${reservation.service?.price ? `${reservation.service.price} SAR` : 'Price not available'}</p>
                
                ${reservation.service?.amenities?.length > 0 ? `
                  <div class="amenities">
                    ${reservation.service.amenities.slice(0, 3).map(amenity => `
                      <span class="amenity-tag">${amenity}</span>
                    `).join('')}
                  </div>
                ` : ''}
                
                ${reservation.specialRequests ? `
                  <div class="special-requests">
                    <p><i class="fas fa-comment"></i> Special Requests:</p>
                    <p>${reservation.specialRequests}</p>
                  </div>
                ` : ''}
              </div>
              
              <div class="reservation-actions">
                ${reservation.status === 'confirmed' ? `
                  <button class="cancel-btn" data-id="${reservation._id}">
                    <i class="fas fa-times"></i> Cancel
                  </button>
                ` : ''}
                <button class="details-btn" data-id="${reservation._id}">
                  <i class="fas fa-info-circle"></i> Details
                </button>
              </div>
            </div>
          `).join('')}
        </div>
      `;

      // Event delegation for cancel and details buttons
      container.addEventListener('click', async (e) => {
        const cancelBtn = e.target.closest('.cancel-btn');
        if (cancelBtn) {
          e.stopPropagation();
          if (confirm('Are you sure you want to cancel this reservation?')) {
            cancelBtn.disabled = true;
            cancelBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cancelling...';
            try {
              await cancelReservation(cancelBtn.dataset.id);
            } finally {
              cancelBtn.disabled = false;
              cancelBtn.innerHTML = '<i class="fas fa-times"></i> Cancel';
            }
          }
        }
        
        const detailsBtn = e.target.closest('.details-btn');
        if (detailsBtn) {
          e.stopPropagation();
          viewReservationDetails(detailsBtn.dataset.id);
        }
      });

    } catch (error) {
      console.error('Failed to load reservations:', error);
      container.innerHTML = `
        <div class="error-state">
          <i class="fas fa-exclamation-triangle"></i>
          <h3>Error Loading Reservations</h3>
          <p>${error.message || 'Please try again later'}</p>
          <button onclick="displayUserReservations()">
            <i class="fas fa-sync-alt"></i> Retry
          </button>
        </div>
      `;
    }
  }

  // Enhanced formatDate function
  function formatDate(dateString) {
    if (!dateString) return 'Not specified';
    const date = new Date(dateString);
    if (isNaN(date.getTime())) return 'Invalid date';
    
    return date.toLocaleDateString('en-US', { 
      weekday: 'short', 
      month: 'short', 
      day: 'numeric',
      year: 'numeric'
    });
  }

  // Enhanced cancelReservation function
  async function cancelReservation(reservationId) {
    try {
      const token = localStorage.getItem('token');
      if (!token) {
        showLoginMessage('cancel reservations');
        return;
      }

      const response = await fetch(`${API_BASE_URL}/reservations/${reservationId}`, {
        method: 'DELETE',
        headers: { 'Authorization': `Bearer ${token}` }
      });

      const data = await response.json();
      
      if (!response.ok) {
        throw new Error(data.message || 'Failed to cancel reservation');
      }

      showSuccessMessage('Reservation cancelled successfully');
      displayUserReservations();
    } catch (error) {
      console.error('Error cancelling reservation:', error);
      showErrorToUser(error.message || 'Failed to cancel reservation');
    }
  }

  function showLoginMessage(action) {
    const loginMessage = document.createElement("div");
    loginMessage.className = "login-message";
    loginMessage.innerHTML = `
      <div class="login-message-content">
        <p>Please login to ${action}.</p>
        <div class="login-actions">
          <button onclick="window.location.href='login.html'">
            Go to Login Page
          </button>
          <button onclick="this.closest('.login-message').remove()">
            Cancel
          </button>
        </div>
      </div>
    `;
    document.body.appendChild(loginMessage);
  }

  function setupFeaturedCards() {
    try {
      document.querySelectorAll('.view-details-btn').forEach(button => {
        button.addEventListener('click', function() {
          const serviceType = this.getAttribute('data-service');
          const modal = getElement(`${serviceType}Modal`);
          if (modal) {
            modal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
          }
        });
      });

      document.querySelectorAll('.book-now-btn').forEach(button => {
        button.addEventListener('click', function() {
          const card = this.closest('.service-card');
          const serviceType = card.querySelector('.view-details-btn').getAttribute('data-service');
          handleReservation(null, serviceType, event);
        });
      });

      document.querySelectorAll('.close-modal').forEach(button => {
        button.addEventListener('click', function() {
          this.closest('.modal').style.display = 'none';
          document.body.style.overflow = 'auto';
        });
      });

      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
          if (e.target === this) {
            this.style.display = 'none';
            document.body.style.overflow = 'auto';
          }
        });
      });
    } catch (error) {
      logError("setupFeaturedCards", error);
    }
  }

  function setupDateInputs() {
  try {
    const now = new Date();
    const tomorrow = new Date();
    tomorrow.setDate(now.getDate() + 1);

    const formatDate = (date) => date.toISOString().split('T')[0];

    const dateInputs = [
      { id: "check-in", date: now },
      { id: "check-out", date: tomorrow },
      { id: "restaurant-date", date: now },
      { id: "car-pickup-date", date: now },
      { id: "car-dropoff-date", date: tomorrow },
      { id: "event-date", date: now }
    ];

    dateInputs.forEach(({id, date}) => {
      const input = getElement(id);
      if (input) {
        input.min = formatDate(now);
        if (!input.value) {
          input.value = formatDate(date);
        }
      }
    });

    // Ensure check-out is after check-in
    const checkIn = getElement("check-in");
    const checkOut = getElement("check-out");
    
    if (checkIn && checkOut) {
      checkIn.addEventListener("change", function() {
        const selectedDate = new Date(this.value);
        const nextDay = new Date(selectedDate);
        nextDay.setDate(selectedDate.getDate() + 1);
        
        checkOut.min = formatDate(nextDay);
        if (new Date(checkOut.value) < nextDay) {
          checkOut.value = formatDate(nextDay);
        }
      });
    }
  } catch (error) {
    logError("setupDateInputs", error);
  }
}

  function setupSearchTabs() {
    try {
      const tabs = document.querySelectorAll(".search-tab");
      const searchForms = {
        hotels: getElement("hotel-search"),
        restaurants: getElement("restaurant-search"),
        cars: getElement("car-search"),
        events: getElement("event-search")
      };

      if (tabs.length > 0) {
        tabs.forEach((tab) => {
          tab.addEventListener("click", function() {
            try {
              tabs.forEach((t) => {
                t.classList.remove("active");
                t.setAttribute("aria-selected", "false");
              });
              this.classList.add("active");
              this.setAttribute("aria-selected", "true");

              Object.values(searchForms).forEach(form => {
                if (form) form.style.display = "none";
              });

              const tabType = this.getAttribute("data-tab");
              console.log(`Search tab changed to: ${tabType}`);
              if (searchForms[tabType]) {
                searchForms[tabType].style.display = "flex";
              }
            } catch (error) {
              logError("search tab click handler", error);
            }
          });
        });

        tabs[0]?.click();
      }
    } catch (error) {
      logError("setupSearchTabs", error);
    }
  }

  function checkAuthState() {
    try {
      const token = localStorage.getItem('token');
      const authButtons = document.querySelector('.auth-buttons');
      const userDropdown = getElement('userDropdown');
      const usernameDisplay = getElement('usernameDisplay');

      if (token) {
        console.log('User token found, updating UI');
        if (authButtons) authButtons.style.display = 'none';
        if (userDropdown) userDropdown.style.display = 'block';
        if (usernameDisplay) {
          try {
            const payload = JSON.parse(atob(token.split('.')[1]));
            usernameDisplay.textContent = payload.name || 'User';
          } catch (e) {
            usernameDisplay.textContent = 'User';
          }
        }
      } else {
        console.log('No user token found');
      }
    } catch (error) {
      logError("checkAuthState", error);
    }
  }

  function setupMobileNav() {
    try {
      const mobileToggle = document.querySelector(".mobile-nav-toggle");
      const nav = getElement("main-nav");

      if (mobileToggle && nav) {
        mobileToggle.addEventListener("click", function() {
          try {
            const isExpanded = nav.classList.toggle("active");
            mobileToggle.setAttribute("aria-expanded", isExpanded);
          } catch (error) {
            logError("mobileToggle click handler", error);
          }
        });

        document.querySelectorAll("nav a").forEach((link) => {
          link.addEventListener("click", () => {
            nav.classList.remove("active");
            mobileToggle.setAttribute("aria-expanded", "false");
          });
        });
      }
    } catch (error) {
      logError("setupMobileNav", error);
    }
  }

 async function updateReservationCount() {
  try {
    const token = localStorage.getItem('token');
    if (!token) return;

    const response = await fetch(`${API_BASE_URL}/reservations`, {
      headers: { 'Authorization': `Bearer ${token}` }
    });

    if (!response.ok) {
      console.log('Failed to get reservations count');
      return;
    }

    const { data: reservations } = await response.json();
    const count = reservations?.length || 0;
    
    document.querySelectorAll('.reservation-count').forEach(el => {
      el.textContent = count;
    });
  } catch (error) {
    console.error('Failed to update reservation count:', error);
  }
}

  function viewReservationDetails(reservationId) {
    // Implement your reservation details view logic here
    console.log('Viewing details for reservation:', reservationId);
    // You might want to show a modal with detailed information
    // or navigate to a details page
    alert(`Showing details for reservation ${reservationId}`);
  }

  document.addEventListener("DOMContentLoaded", function() {
    console.log('DOM fully loaded and parsed');
    try {
      const currentYearEl = getElement("current-year");
      if (currentYearEl) currentYearEl.textContent = new Date().getFullYear();

      if (window.location.pathname.includes('reservations.html')) {
        displayUserReservations();
      }
      
      updateReservationCount();
      checkAuthState();
      setupMobileNav();
      setupSearchTabs();
      setupSorting();
      setupDateInputs();
      setupFeaturedCards();

      const fetchAllBtn = document.getElementById('fetchAllBtn');
      if (fetchAllBtn) fetchAllBtn.addEventListener('click', fetchAllServices);

      document.querySelectorAll('.search-form').forEach(form => {
        form.addEventListener('submit', handleSearchFormSubmit);
      });

      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('book-btn')) {
          const serviceId = e.target.getAttribute('data-id');
          const serviceType = e.target.getAttribute('data-type');
          handleReservation(serviceId, serviceType, e);
        }
      });

      const logoutBtn = getElement('logoutBtn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
          localStorage.removeItem('token');
          window.location.href = 'index.html';
        });
      }

      console.log('Page initialization complete');
    } catch (error) {
      logError("DOMContentLoaded", error);
    }
  });
</script>
  </body>
</html>
